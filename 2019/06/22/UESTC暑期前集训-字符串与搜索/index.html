<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="A - qh与复读机I A、每次按顺序给出$ n $个字符串，求出每个字符串是前面多少个字符串的前缀和后缀  tire树因为题面给定数据范围$\sum |S_i| &amp;lt; 1e6$，也就是说如果建一棵树的话结点数是不会超过这么多的，而且遍历的时候也是，那么考虑正序和逆序建树，每次建树的同时到达最后一个结点返回当前结点已经记录的单词数量，也就分别对应了前缀和后缀时间复杂度$O(n)$1234567">
<meta name="keywords" content="字符串,ACM,搜索">
<meta property="og:type" content="article">
<meta property="og:title" content="UESTC暑假前集训-字符串与搜索-解题报告">
<meta property="og:url" content="http://decision01.cn/2019/06/22/UESTC暑期前集训-字符串与搜索/index.html">
<meta property="og:site_name" content="Decision&#39;s Blog">
<meta property="og:description" content="A - qh与复读机I A、每次按顺序给出$ n $个字符串，求出每个字符串是前面多少个字符串的前缀和后缀  tire树因为题面给定数据范围$\sum |S_i| &amp;lt; 1e6$，也就是说如果建一棵树的话结点数是不会超过这么多的，而且遍历的时候也是，那么考虑正序和逆序建树，每次建树的同时到达最后一个结点返回当前结点已经记录的单词数量，也就分别对应了前缀和后缀时间复杂度$O(n)$1234567">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-06-22T04:18:30.953Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="UESTC暑假前集训-字符串与搜索-解题报告">
<meta name="twitter:description" content="A - qh与复读机I A、每次按顺序给出$ n $个字符串，求出每个字符串是前面多少个字符串的前缀和后缀  tire树因为题面给定数据范围$\sum |S_i| &amp;lt; 1e6$，也就是说如果建一棵树的话结点数是不会超过这么多的，而且遍历的时候也是，那么考虑正序和逆序建树，每次建树的同时到达最后一个结点返回当前结点已经记录的单词数量，也就分别对应了前缀和后缀时间复杂度$O(n)$1234567">



  <link rel="alternate" href="/atom.xml" title="Decision's Blog" type="application/atom+xml">




  <link rel="canonical" href="http://decision01.cn/2019/06/22/UESTC暑期前集训-字符串与搜索/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>UESTC暑假前集训-字符串与搜索-解题报告 | Decision's Blog</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Decision's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">山河犹在 故人长绝</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://decision01.cn/2019/06/22/UESTC暑期前集训-字符串与搜索/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Decision">
      <meta itemprop="description" content="山河犹在 故人长绝">
      <meta itemprop="image" content="https://s.gravatar.com/avatar/d3c332e47b56134bab228c086c6578d5?s=250">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Decision's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">UESTC暑假前集训-字符串与搜索-解题报告

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-22 12:02:27 / 修改时间：12:18:30" itemprop="dateCreated datePublished" datetime="2019-06-22T12:02:27+08:00">2019-06-22</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/UESTC/" itemprop="url" rel="index"><span itemprop="name">UESTC</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/UESTC/ACM/" itemprop="url" rel="index"><span itemprop="name">ACM</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/06/22/UESTC暑期前集训-字符串与搜索/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/06/22/UESTC暑期前集训-字符串与搜索/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2019/06/22/UESTC暑期前集训-字符串与搜索/" class="leancloud_visitors" data-flag-title="UESTC暑假前集训-字符串与搜索-解题报告">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h5 id="A-qh与复读机I"><a href="#A-qh与复读机I" class="headerlink" title="A - qh与复读机I"></a>A - qh与复读机I</h5><blockquote>
<p>A、每次按顺序给出$ n $个字符串，求出每个字符串是前面多少个字符串的前缀和后缀</p>
</blockquote>
<p><code>tire树</code><br>因为题面给定数据范围$\sum |S_i| &lt; 1e6$，也就是说如果建一棵树的话结点数是不会超过这么多的，而且遍历的时候也是，那么考虑正序和逆序建树，每次建树的同时到达最后一个结点返回当前结点已经记录的单词数量，也就分别对应了前缀和后缀<br>时间复杂度$O(n)$<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1000007</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> child[<span class="number">26</span>];</span><br><span class="line">	<span class="keyword">int</span> sum;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++) child[i] = <span class="number">0</span>;</span><br><span class="line">		sum = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;Tree[<span class="number">2</span>][maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cnt1 = <span class="number">0</span>,cnt2 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(<span class="keyword">bool</span> statu,<span class="keyword">const</span> <span class="built_in">string</span>&amp; s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> len = s.length();</span><br><span class="line">	<span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line">		<span class="keyword">int</span> pos = s[i] - <span class="string">'a'</span>;</span><br><span class="line">		<span class="keyword">if</span>(Tree[statu][now].child[pos] == <span class="number">0</span>)&#123;</span><br><span class="line">			<span class="keyword">int</span> nxt = (statu ? ++cnt2 : ++cnt1);</span><br><span class="line">			Tree[statu][now].child[pos] = nxt;</span><br><span class="line">			Tree[statu][nxt].init();</span><br><span class="line">		&#125;</span><br><span class="line">		now = Tree[statu][now].child[pos];</span><br><span class="line">		Tree[statu][now].sum ++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> Tree[statu][now].sum - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">string</span> s;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;s;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;insert(<span class="number">0</span>,s)&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">		reverse(s.begin(),s.end());</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;insert(<span class="number">1</span>,s)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="B-qh与复读机II"><a href="#B-qh与复读机II" class="headerlink" title="B - qh与复读机II"></a>B - qh与复读机II</h5><blockquote>
<p>B、给定一个字符串$ S $，求出这个字符串的所有循环节大小</p>
</blockquote>
<p><code>KMP</code> <code>fail数组</code><br>有一个结论是字符串的$ border $的 $border$还是这个字符串的$border$，那么用KMP算法求出fail数组后，对应的就是$border$，那么就依次求出$fail[n]、fail[fail[n]]…..$然后用原串长度减去就可以了<br>直接把以前写的KMP算法拿过来了（逃<br>时间复杂度$O(n)$<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> s[<span class="number">1000007</span>]; </span><br><span class="line"><span class="keyword">int</span> nxt[<span class="number">1000007</span>];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KMP</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">    nxt[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    nxt[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i&lt;len;i++)&#123;</span><br><span class="line">        j = nxt[i];</span><br><span class="line">        <span class="keyword">while</span>(s[i]!=s[j]&amp;&amp;j) j = nxt[j];</span><br><span class="line">        nxt[i+<span class="number">1</span>] = s[i]==s[j]?j+<span class="number">1</span>:<span class="number">0</span>; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;s;</span><br><span class="line">    KMP(s);</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">int</span> x = nxt[len];</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        ans.push_back(len - x);</span><br><span class="line">        x = nxt[x];</span><br><span class="line">    &#125;</span><br><span class="line">    ans.push_back(len);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; ans.size();i++) <span class="built_in">cout</span>&lt;&lt;ans[i]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="C-qh与复读机III"><a href="#C-qh与复读机III" class="headerlink" title="C - qh与复读机III"></a>C - qh与复读机III</h5><blockquote>
<p>C、给出字符串$ S $和$ T $，求出$ T $在$ S $中出现的每一个位置</p>
</blockquote>
<p><code>KMP</code><br>KMP板题，求出匹配位置即可，时间复杂度$O(n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> s1[<span class="number">1000007</span>],s2[<span class="number">1000007</span>]; </span><br><span class="line"><span class="keyword">int</span> nxt[<span class="number">1000007</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KMP</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">    nxt[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    nxt[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i&lt;len;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        j = nxt[i];</span><br><span class="line">        <span class="keyword">while</span>(s[i]!=s[j]&amp;&amp;j) j = nxt[j];</span><br><span class="line">        nxt[i+<span class="number">1</span>] = s[i]==s[j]?j+<span class="number">1</span>:<span class="number">0</span>; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">strlen</span>(s1),m = <span class="built_in">strlen</span>(s2);</span><br><span class="line">    <span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">while</span>(s1[i]!=s2[j]&amp;&amp;j) j = nxt[j];</span><br><span class="line">        <span class="keyword">if</span>(s1[i]==s2[j]) j++;</span><br><span class="line">        <span class="keyword">if</span>(j==m)&#123;<span class="built_in">cout</span>&lt;&lt;i-j+<span class="number">2</span>&lt;&lt;<span class="string">" "</span>;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;s1&gt;&gt;s2;</span><br><span class="line">    KMP(s2);</span><br><span class="line">    solve();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="D-qh与复读机IV"><a href="#D-qh与复读机IV" class="headerlink" title="D - qh与复读机IV"></a>D - qh与复读机IV</h5><blockquote>
<p>D、给出一堆模式串$T_i$，求出每个模式串在待匹配串里面的出现次数</p>
</blockquote>
<p><code>AC自动机</code><br>AC自动机的板题，把模式串放到AC自动机里面然后用匹配串放进去匹配求出次数输出即可，这个题没有加强数据，所以平常的AC自动机就可以过</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">char</span> s1[<span class="number">1000007</span>],s2[<span class="number">1000007</span>];</span><br><span class="line"><span class="keyword">int</span> ans[<span class="number">100007</span>];</span><br><span class="line"><span class="keyword">int</span> tid[<span class="number">100007</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">acnode</span>&#123;</span></span><br><span class="line">    acnode *child[<span class="number">26</span>];</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    acnode *fail;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(acnode *root)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;<span class="number">26</span>;i++) root-&gt;child[i] = <span class="literal">NULL</span>;</span><br><span class="line">    root-&gt;id = <span class="number">0</span>;</span><br><span class="line">    root-&gt;fail = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(acnode *root,<span class="keyword">char</span> *s,<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    acnode *t = root;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> pos = s[i] - <span class="string">'a'</span>;</span><br><span class="line">        <span class="keyword">if</span>(t-&gt;child[pos] == <span class="literal">NULL</span>)&#123;</span><br><span class="line">            acnode *newnode = <span class="keyword">new</span> acnode;</span><br><span class="line">            init(newnode);</span><br><span class="line">            t-&gt;child[pos] = newnode;</span><br><span class="line">        &#125;</span><br><span class="line">        t = t-&gt;child[pos];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(t -&gt; id != <span class="number">0</span>) tid[id] = t -&gt; id;</span><br><span class="line">    <span class="keyword">else</span> t -&gt; id = id,tid[id] = t -&gt; id;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getfail</span><span class="params">(acnode *root)</span></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;acnode*&gt; q;</span><br><span class="line">    q.push(root);</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        acnode *now = q.front();</span><br><span class="line">        q.pop();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;<span class="number">26</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(now-&gt;child[i] != <span class="literal">NULL</span>)&#123;</span><br><span class="line">                acnode *p;</span><br><span class="line">                <span class="keyword">if</span>(now == root)&#123;</span><br><span class="line">                    now-&gt;child[i]-&gt;fail = root;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    p = now-&gt;fail;</span><br><span class="line">                    <span class="keyword">while</span>(p != <span class="literal">NULL</span>)&#123;</span><br><span class="line">                        <span class="keyword">if</span>(p-&gt;child[i] != <span class="literal">NULL</span>)&#123;</span><br><span class="line">                            now-&gt;child[i]-&gt;fail = p-&gt;child[i];</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        p = p-&gt;fail;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(p == <span class="literal">NULL</span>) now-&gt;child[i]-&gt;fail = root;</span><br><span class="line">                &#125;</span><br><span class="line">                q.push(now-&gt;child[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(acnode *root,<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">    acnode *p = root;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> pos = s[i] - <span class="string">'a'</span>;</span><br><span class="line">        <span class="keyword">while</span>(p-&gt;child[pos] == <span class="literal">NULL</span> &amp;&amp; p!= root) p = p-&gt;fail;</span><br><span class="line">        p = p-&gt;child[pos];</span><br><span class="line">        <span class="keyword">if</span>(!p) p = root;</span><br><span class="line">        acnode *now = p;</span><br><span class="line">        <span class="keyword">while</span>(now != root)&#123;</span><br><span class="line">            <span class="keyword">if</span>(now-&gt;id &gt; <span class="number">0</span>)</span><br><span class="line">                ans[now-&gt;id] ++;</span><br><span class="line">            now = now-&gt;fail;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">acnode *root;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;s2;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    root = <span class="keyword">new</span> acnode;</span><br><span class="line">    init(root);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;s1;</span><br><span class="line">        insert(root,s1,i);</span><br><span class="line">    &#125;</span><br><span class="line">    getfail(root);</span><br><span class="line">    query(root,s2);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">    	<span class="built_in">cout</span>&lt;&lt;ans[tid[i]]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="E-qh与复读机V"><a href="#E-qh与复读机V" class="headerlink" title="E - qh与复读机V"></a>E - qh与复读机V</h5><blockquote>
<p>E、和上一个题一样，但是有数据加强</p>
</blockquote>
<p><code>AC自动机</code> <code>last优化</code><br>这个题我改成了用数组写，因为指针写优化容易出现空指针的问题，所以改成用数组写要稳妥一点。。。加一个last优化直接跳到对应的位置避免了重复跳位置的效率低下</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n,cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> s1[<span class="number">1000007</span>],s2[<span class="number">1000007</span>];</span><br><span class="line"><span class="keyword">int</span> ans[<span class="number">100007</span>];</span><br><span class="line"><span class="keyword">int</span> tid[<span class="number">100007</span>];</span><br><span class="line"><span class="keyword">int</span> last[<span class="number">1000007</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">acnode</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> child[<span class="number">26</span>];</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">int</span> fail;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++) child[i] = <span class="number">0</span>;</span><br><span class="line">        fail = <span class="number">0</span>;</span><br><span class="line">        id = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;Node[<span class="number">1000007</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> *s,<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(Node[now].child[s[i] - <span class="string">'a'</span>] == <span class="number">0</span>)&#123;</span><br><span class="line">            Node[now].child[s[i] - <span class="string">'a'</span>] = ++cnt;</span><br><span class="line">            Node[cnt].init();</span><br><span class="line">        &#125;</span><br><span class="line">        now = Node[now].child[s[i] - <span class="string">'a'</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(Node[now].id == <span class="number">0</span>) Node[now].id = id,tid[id] = id;</span><br><span class="line">    <span class="keyword">else</span> tid[id] = Node[now].id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getfail</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(Node[<span class="number">0</span>].child[i] != <span class="number">0</span>)&#123;</span><br><span class="line">            Node[Node[<span class="number">0</span>].child[i]].fail = <span class="number">0</span>;</span><br><span class="line">            q.push(Node[<span class="number">0</span>].child[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.front();</span><br><span class="line">        q.pop();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(Node[now].child[i] != <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> nxt = Node[now].child[i];</span><br><span class="line">                Node[Node[now].child[i]].fail = Node[Node[now].fail].child[i];</span><br><span class="line">                q.push(Node[now].child[i]);</span><br><span class="line">                last[nxt] = Node[Node[nxt].fail].id ? Node[nxt].fail : last[Node[nxt].fail]; </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> Node[now].child[i] = Node[Node[now].fail].child[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line">        now = Node[now].child[s[i] - <span class="string">'a'</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> t = now;t;t = last[t])&#123;</span><br><span class="line">            <span class="keyword">if</span>(Node[t].id &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                ans[Node[t].id] ++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;s2;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;s1;</span><br><span class="line">        insert(s1,i);</span><br><span class="line">    &#125;</span><br><span class="line">    getfail();</span><br><span class="line">    query(s2);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;ans[tid[i]]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="F-qh与复读机VI"><a href="#F-qh与复读机VI" class="headerlink" title="F - qh与复读机VI"></a>F - qh与复读机VI</h5><blockquote>
<p>F、给定一个字符串$S$，以及一个字符串$T$，要求求出所有的$S$的子串与$T$的一个前缀拼起来是回文串的情况的总数，而且要求子串长度大于前缀</p>
</blockquote>
<p><code>exkmp</code> <code>manacher</code><br>一开始找字符串算法的时候发现了exkmp这个东西，可以求出一个串的所有后缀和另外一个串的最长前缀，然后感觉可以用一下，没有注意读题导致我以为是长度没有关系要找出所有的拼起来的是回文的情况有多少。。<br>然后我就傻逼的写了一发exkmp求出对应的extend数组就放上去了。。后面一看题目，然后看了一下样例（其实样例给的很明显了，就中间回文然后两边是相同的）<br>那么就是需要manacher和exkmp，exkmp的时候把原串倒过来，求出每个位置开头的回文串数量和这个位置对应的extend数组然后相乘相加即可<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> s,t;</span><br><span class="line">ll nxt[<span class="number">1000007</span>],exnxt[<span class="number">1000007</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s2[<span class="number">2000007</span>];</span><br><span class="line">ll p[<span class="number">2000007</span>],id = <span class="number">1</span>,mx = <span class="number">1</span>,ans = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">ll pre[<span class="number">2000007</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KMP</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ll len = t.length(),pos,i = <span class="number">0</span>,j;</span><br><span class="line">    nxt[<span class="number">0</span>] = len;</span><br><span class="line">    <span class="keyword">while</span>(t[i] == t[i + <span class="number">1</span>] &amp;&amp; i + <span class="number">1</span> &lt; len) i++;</span><br><span class="line">    nxt[<span class="number">1</span>] = i;</span><br><span class="line">    pos = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">2</span>;i &lt; len;i++)&#123;</span><br><span class="line">    	<span class="keyword">if</span>(nxt[i - pos] + i &lt; nxt[pos] + pos) nxt[i] = nxt[i - pos];</span><br><span class="line">    	<span class="keyword">else</span>&#123;</span><br><span class="line">    		j = nxt[pos] + pos - i;</span><br><span class="line">    		<span class="keyword">if</span>(j &lt; <span class="number">0</span>) j = <span class="number">0</span>;</span><br><span class="line">    		<span class="keyword">while</span>(i + j &lt; len &amp;&amp; t[i + j] == t[j]) j++;</span><br><span class="line">    		nxt[i] = j;</span><br><span class="line">    		pos = i;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exkmp</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ll i = <span class="number">0</span>,j,pos = <span class="number">0</span>,len1 = s.length(),len2 = t.length();</span><br><span class="line">	<span class="keyword">while</span>(s[i] == t[i] &amp;&amp; i &lt; len1 &amp;&amp; i &lt; len2) i++;</span><br><span class="line">	exnxt[<span class="number">0</span>] = i;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">1</span>;i &lt; len1;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(nxt[i - pos] + i &lt; exnxt[pos] + pos) exnxt[i] = nxt[i - pos];</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			j = exnxt[pos] + pos - i;</span><br><span class="line">			<span class="keyword">if</span>(j &lt; <span class="number">0</span>) j = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>(i + j &lt; len1 &amp;&amp; j &lt; len2 &amp;&amp; s[j + i] == t[j]) j++;</span><br><span class="line">			exnxt[i] = j;</span><br><span class="line">			pos = i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    s2[<span class="number">0</span>] = <span class="string">'$'</span>;</span><br><span class="line">    s2[<span class="number">1</span>] = <span class="string">'#'</span>;</span><br><span class="line">    ll j = <span class="number">2</span>;</span><br><span class="line">    ll len = s.length();</span><br><span class="line">    <span class="keyword">for</span>(ll i = <span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        s2[j++] = s[i];</span><br><span class="line">        s2[j++] = <span class="string">'#'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    s2[j] = <span class="string">'\0'</span>;</span><br><span class="line">    <span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">manacher</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ll len = init();</span><br><span class="line">	<span class="keyword">for</span>(ll i = <span class="number">1</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i &lt; mx) p[i] = min(p[<span class="number">2</span> * id - i],mx - i);</span><br><span class="line">        <span class="keyword">else</span> p[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(s2[i - p[i]] == s2[i + p[i]]) p[i] ++;</span><br><span class="line">        <span class="keyword">if</span>(mx &lt; i + p[i])&#123;</span><br><span class="line">            id = i;</span><br><span class="line">            mx = i + p[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;s&gt;&gt;t;</span><br><span class="line">	manacher();</span><br><span class="line">	ll len = s.length();</span><br><span class="line">	<span class="keyword">for</span>(ll i = len * <span class="number">2</span>;i &gt;= <span class="number">2</span>;i--)&#123;</span><br><span class="line">		ll x = i / <span class="number">2</span>;</span><br><span class="line">		pre[x]++;</span><br><span class="line">		pre[x - (p[i] / <span class="number">2</span>)] --;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(ll i = len;i &gt;= <span class="number">1</span>;i--) pre[i] += pre[i + <span class="number">1</span>];</span><br><span class="line">	reverse(s.begin(),s.end());</span><br><span class="line">	KMP();</span><br><span class="line">	exkmp();</span><br><span class="line">	ll ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(ll i = <span class="number">1</span>;i &lt;= len;i++)&#123;</span><br><span class="line">		ans += exnxt[len - i + <span class="number">1</span>] * pre[i] * <span class="number">1L</span>L;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="G-qh与复读机VII"><a href="#G-qh与复读机VII" class="headerlink" title="G - qh与复读机VII"></a>G - qh与复读机VII</h5><blockquote>
<p>G、给出一个数字串已经一个模数，求出对应数字串的每个不同回文数相加的和在取模后的值的大小</p>
</blockquote>
<p><code>快速幂</code> <code>回文自动机</code><br>果然是个回文自动机的板题。。。每个节点对应了一个回文串，那么每次加到这个节点的时候根据上面位置的回文对应的值算出来这个回文的值再加进答案就好了。。当然要注意的是长度奇数和偶数不同情况要处理一下，取10的高次方的时候用快速幂取模<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> child[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">int</span> fail,len;</span><br><span class="line">    ll value;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        mst(child,<span class="number">0</span>);</span><br><span class="line">        fail = len = <span class="number">0</span>;</span><br><span class="line">        value = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;node[maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> last,tot = <span class="number">0</span>;</span><br><span class="line">ll ans = <span class="number">0</span>,xyy;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">QuickMod</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span>,t = a;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = (res * t) % xyy;</span><br><span class="line">        t = (t * t) % xyy;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> c,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p = last;</span><br><span class="line">    <span class="keyword">while</span>(s[x - node[p].len - <span class="number">1</span>] != s[x]) p = node[p].fail;</span><br><span class="line">    <span class="keyword">if</span>(!node[p].child[c])&#123;</span><br><span class="line">        <span class="keyword">int</span> v = ++tot,k = node[p].fail;</span><br><span class="line">        node[v].len = node[p].len + <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">while</span>(s[x - node[k].len - <span class="number">1</span>] != s[x]) k = node[k].fail;</span><br><span class="line">        node[v].fail = node[k].child[c];</span><br><span class="line">        node[p].child[c] = v;</span><br><span class="line">        <span class="keyword">if</span>(p == <span class="number">1</span>)&#123;</span><br><span class="line">            node[v].value = c;</span><br><span class="line">            ans = (ans + c) % xyy;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ll value = (node[p].value * <span class="number">10</span> % xyy + c * QuickMod(<span class="number">10</span>,node[v].len - <span class="number">1</span> % xyy) + c) % xyy;</span><br><span class="line">            ans = (ans + value) % xyy;</span><br><span class="line">            node[v].value = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    last = node[p].child[c];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    node[<span class="number">0</span>].init();</span><br><span class="line">    node[<span class="number">1</span>].init();</span><br><span class="line">    node[<span class="number">0</span>].fail = <span class="number">1</span>;</span><br><span class="line">    node[<span class="number">1</span>].len = <span class="number">-1</span>;</span><br><span class="line">    tot = <span class="number">1</span>;</span><br><span class="line">    last = <span class="number">0</span>;</span><br><span class="line">    s[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;s + <span class="number">1</span>&gt;&gt;xyy;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;s[i];i++)&#123;</span><br><span class="line">        insert(s[i] - <span class="string">'0'</span>,i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="H-qh与复读机VIII"><a href="#H-qh与复读机VIII" class="headerlink" title="H - qh与复读机VIII"></a>H - qh与复读机VIII</h5><blockquote>
<p>H、给出一堆模式串以及对应的权重，要求组出一个字符串让其权重和最大，对应某一个模式串出现一次算一次这个模式串的权重，字符串长度限制为$L$</p>
</blockquote>
<p><code>AC自动机</code> <code>trie图</code><br>将每个模式串以及对应权重放到AC自动机里面，在AC自动机里面跑一遍动态规划求出一个最长的路径，如果动态规划的话，设$f_{i,j}$为长度为i到达AC自动机的第$j$个对应结点的时候得到的最大权重，$S_k$表示的是对应于$k$结点在trie图上的后继集合，转移方程：</p>
<script type="math/tex; mode=display">
f_{i,j} = max \{ f_{i,k} + w_j | j \in S_k \}</script><p>我写到中间的时候甚至想把图扒出来跑最长路来着。。。但是写不出来还是弃了<br>要从根节点开始，然后到不了的结点设置为inf，然后后面的更新状态也差不多，每次拓展的时候要当前到的结点不是inf才能往下更新<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">acnode</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> child[<span class="number">26</span>];</span><br><span class="line">    ll val;</span><br><span class="line">    <span class="keyword">int</span> fail;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++) child[i] = <span class="number">0</span>;</span><br><span class="line">        fail = <span class="number">0</span>;</span><br><span class="line">        val = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;Node[<span class="number">1000007</span>];</span><br><span class="line"></span><br><span class="line">ll cnt;</span><br><span class="line">ll n,l,w;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">600</span>];</span><br><span class="line">ll f[<span class="number">2007</span>][<span class="number">600</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getfail</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(Node[<span class="number">0</span>].child[i] != <span class="number">0</span>)&#123;</span><br><span class="line">            Node[Node[<span class="number">0</span>].child[i]].fail = <span class="number">0</span>;</span><br><span class="line">            q.push(Node[<span class="number">0</span>].child[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.front();</span><br><span class="line">        q.pop();</span><br><span class="line">        <span class="keyword">if</span>(Node[Node[now].fail].val) Node[now].val += Node[Node[now].fail].val;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(Node[now].child[i] != <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> nxt = Node[now].child[i];</span><br><span class="line">                Node[nxt].fail = Node[Node[now].fail].child[i];</span><br><span class="line">                q.push(nxt);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> Node[now].child[i] = Node[Node[now].fail].child[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(Node[now].child[s[i] - <span class="string">'a'</span>] == <span class="number">0</span>)&#123;</span><br><span class="line">            Node[now].child[s[i] - <span class="string">'a'</span>] = ++cnt;</span><br><span class="line">            Node[cnt].init();</span><br><span class="line">        &#125;</span><br><span class="line">        now = Node[now].child[s[i] - <span class="string">'a'</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    Node[now].val += w;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;s&gt;&gt;w;</span><br><span class="line">        insert(s);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;l;</span><br><span class="line">    getfail();</span><br><span class="line">    mst(f,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= cnt;i++)&#123;</span><br><span class="line">        f[<span class="number">1</span>][i] = f[<span class="number">2</span>][i] = -INF;</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= l;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt;= cnt;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(f[<span class="number">1</span>][j] == -INF) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k &lt; <span class="number">26</span>;k++)&#123;</span><br><span class="line">                <span class="keyword">int</span> nxt = Node[j].child[k];</span><br><span class="line">                f[<span class="number">2</span>][nxt] = max(f[<span class="number">2</span>][nxt],f[<span class="number">1</span>][j] + Node[nxt].val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt;= cnt;j++) f[<span class="number">1</span>][j] = f[<span class="number">2</span>][j];</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= cnt;i++) ans = max(ans,f[<span class="number">1</span>][i]);</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="I-qh与复读机IX"><a href="#I-qh与复读机IX" class="headerlink" title="I - qh与复读机IX"></a>I - qh与复读机IX</h5><blockquote>
<p>I、给出一堆模式串，要求求出长度小于等于$L$并且包含其中任意一个字符串为子串的字符串的总类数量</p>
</blockquote>
<p><code>AC自动机</code> <code>矩阵乘法</code> <code>快速幂</code><br>和上面的类似，不过这里的话需要把一trie图中能到达的位置放在矩阵里面，将trie图建成一个邻接矩阵，在图论中一个邻接矩阵$A$，那么$A^k$表示的是路径长度为$k$的对应邻接矩阵，但是这里要求的是至少存在一个模式串的，那么反过来考虑，求出所有的不包含的，剩下的就是包含的，就把trie图上不可达的路径在矩阵中表示出来，求出$l$次幂，统计答案之后，$26^l$表示的是全排列的情况，直接减去就可以，注意取模<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">acnode</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> child[<span class="number">26</span>];</span><br><span class="line">    <span class="keyword">int</span> val;</span><br><span class="line">    <span class="keyword">int</span> fail;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++) child[i] = <span class="number">0</span>;</span><br><span class="line">        fail = <span class="number">0</span>;</span><br><span class="line">        val = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;Node[<span class="number">1000007</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">matrix</span>&#123;</span></span><br><span class="line">    ll num[<span class="number">250</span>][<span class="number">250</span>];</span><br><span class="line">    ll w,h;</span><br><span class="line"></span><br><span class="line">    matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> matrix&amp; a) <span class="keyword">const</span>&#123;</span><br><span class="line">        matrix res;</span><br><span class="line">        mst(res.num,<span class="number">0</span>);</span><br><span class="line">        res.h = h;</span><br><span class="line">        res.w = a.w;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= h;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= a.w;j++)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= w;k++)&#123;</span><br><span class="line">                    res.num[i][j] = (res.num[i][j] + num[i][k] * a.num[k][j] % mod) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(ll hh,ll ww)</span></span>&#123;</span><br><span class="line">        h = hh;</span><br><span class="line">        w = ww;</span><br><span class="line">        mst(num,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= h;i++) num[i][i] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ll n,l,cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ss[<span class="number">1000</span>];</span><br><span class="line">matrix f,x;</span><br><span class="line">ll ans;</span><br><span class="line"></span><br><span class="line"><span class="function">matrix <span class="title">MatrixQuickMod</span><span class="params">(<span class="keyword">const</span> matrix&amp; a,ll b)</span></span>&#123;</span><br><span class="line">    matrix t = a,res;</span><br><span class="line">    res.init(a.h,a.w);</span><br><span class="line">    <span class="keyword">if</span>(b &lt;= <span class="number">0</span>) <span class="keyword">return</span> res;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b &amp; <span class="number">1</span>) res = res * t;</span><br><span class="line">        t = t * t;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(Node[now].child[s[i] - <span class="string">'a'</span>] == <span class="number">0</span>)&#123;</span><br><span class="line">            Node[now].child[s[i] - <span class="string">'a'</span>] = ++cnt;</span><br><span class="line">            Node[cnt].init();</span><br><span class="line">        &#125;</span><br><span class="line">        now = Node[now].child[s[i] - <span class="string">'a'</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    Node[now].val = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getfail</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(Node[<span class="number">0</span>].child[i] != <span class="number">0</span>)&#123;</span><br><span class="line">            Node[Node[<span class="number">0</span>].child[i]].fail = <span class="number">0</span>;</span><br><span class="line">            q.push(Node[<span class="number">0</span>].child[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.front();</span><br><span class="line">        q.pop();</span><br><span class="line">        <span class="keyword">if</span>(Node[Node[now].fail].val == <span class="number">1</span>) Node[now].val = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(Node[now].child[i] != <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> nxt = Node[now].child[i];</span><br><span class="line">                Node[Node[now].child[i]].fail = Node[Node[now].fail].child[i];</span><br><span class="line">                q.push(Node[now].child[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> Node[now].child[i] = Node[Node[now].fail].child[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;ss;</span><br><span class="line">        insert(ss);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;l;</span><br><span class="line">    getfail();</span><br><span class="line">    cnt++;</span><br><span class="line">    f.w = f.h = cnt + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; cnt;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">26</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(Node[Node[i].child[j]].val == <span class="number">0</span>) f.num[i + <span class="number">1</span>][Node[i].child[j] + <span class="number">1</span>]++; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= cnt;i++) f.num[i + <span class="number">1</span>][cnt + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    f = MatrixQuickMod(f,l);</span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cnt + <span class="number">1</span>;i++) ans = (ans + f.num[<span class="number">1</span>][i]) % mod;</span><br><span class="line">    f.num[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">26</span>;</span><br><span class="line">    f.num[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    f.num[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">    f.num[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">    f.w = f.h = <span class="number">2</span>;</span><br><span class="line">    f = MatrixQuickMod(f,l + <span class="number">1</span>);</span><br><span class="line">    ans = f.num[<span class="number">1</span>][<span class="number">2</span>] - ans;</span><br><span class="line">    ans = (ans + mod) % mod;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="J-qh与复读机X"><a href="#J-qh与复读机X" class="headerlink" title="J - qh与复读机X"></a>J - qh与复读机X</h5><blockquote>
<p>J、给出一堆模式串，求出每个模式串在所有的模式串中出现的次数</p>
</blockquote>
<p><code>AC自动机</code> <code>SAM</code><br>本来一开始我的想法是每个模式串中间用#号隔开然后拼接，跑一遍AC自动机，结果交上去是TLE。。。（下来之后cjj说我的string+string的那个位置复杂度可能有点大）<br>然后我换成了SAM，直接求出对应的right集合的大小统计一下。。然后就是答案了。。<br><del>然后复杂度的话。。。自动机的复杂度我算不来（逃</del><br><del>后缀自动机txdy!</del><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> s1[maxn],s2[maxn];</span><br><span class="line"><span class="keyword">int</span> len2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> len[maxn],ans[maxn],sum[maxn],tmp[maxn],ccnt[maxn];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> last = <span class="number">1</span>,cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> ch[maxn][<span class="number">27</span>],fa[maxn&lt;&lt;<span class="number">1</span>],l[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p=last,np=++cnt;</span><br><span class="line">    last=np,l[np]=l[p]+<span class="number">1</span>;</span><br><span class="line">    ccnt[np] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(;p&amp;&amp;!ch[p][c];p=fa[p]) ch[p][c]=np;</span><br><span class="line">    <span class="keyword">if</span>(!p) fa[np]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> q=ch[p][c];</span><br><span class="line">        <span class="keyword">if</span>(l[q]==l[p]+<span class="number">1</span>) fa[np]=q;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> nq=++cnt;l[nq]=l[p]+<span class="number">1</span>;</span><br><span class="line">            <span class="built_in">memcpy</span>(ch[nq],ch[q],<span class="keyword">sizeof</span>(ch[q]));</span><br><span class="line">            fa[nq]=fa[q];fa[q]=fa[np]=nq;</span><br><span class="line">            <span class="keyword">for</span>(;ch[p][c]==q;p=fa[p]) ch[p][c]=nq;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cal</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cnt;i++) sum[l[i]]++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cnt;i++) sum[i] += sum[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cnt;i++) tmp[sum[l[i]]--] = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = cnt;i;i--) ccnt[fa[tmp[i]]] += ccnt[tmp[i]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;s1;</span><br><span class="line">        len[i] = <span class="built_in">strlen</span>(s1);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j  = <span class="number">0</span>;j &lt; len[i];j++) insert(s2[++len2] = s1[j] - <span class="string">'a'</span>);</span><br><span class="line">        insert(s2[++len2] = <span class="number">26</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    cal();</span><br><span class="line">    len2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> x = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; len[i];j++)  x = ch[x][s2[++len2]];</span><br><span class="line">        ans[i] = ccnt[x];</span><br><span class="line">        ++len2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">cout</span>&lt;&lt;ans[i]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="K-qh与复读机XI"><a href="#K-qh与复读机XI" class="headerlink" title="K - qh与复读机XI"></a>K - qh与复读机XI</h5><blockquote>
<p>K、给出一个字符串$S$，要求输出长度为$1到|S|$的出现次数最多的子串的数量</p>
</blockquote>
<p><code>SAM</code> <code>基数排序``right集合</code> <code>Parent树</code><br>SAM的每个节点都对应了一类的子串，那么统计每个right集合的大小，right的集合大小按照parent树往上加，然后根据maxlen数组依次求出对应长度子串的大小最后输出答案即可</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> s1[<span class="number">2000007</span>];</span><br><span class="line"><span class="keyword">int</span> len = <span class="number">0</span>,ans[<span class="number">2000007</span>],sum[<span class="number">2000007</span>],f[<span class="number">2000007</span>];</span><br><span class="line"><span class="keyword">int</span> id[<span class="number">2000007</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> last = <span class="number">1</span>,cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> ch[maxn][<span class="number">26</span>],fa[maxn&lt;&lt;<span class="number">1</span>],l[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p=last,np=++cnt;</span><br><span class="line">    last=np,l[np]=l[p]+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(;p&amp;&amp;!ch[p][c];p=fa[p]) ch[p][c]=np;</span><br><span class="line">    <span class="keyword">if</span>(!p) fa[np]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> q=ch[p][c];</span><br><span class="line">        <span class="keyword">if</span>(l[q]==l[p]+<span class="number">1</span>) fa[np]=q;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> nq=++cnt;l[nq]=l[p]+<span class="number">1</span>;</span><br><span class="line">            <span class="built_in">memcpy</span>(ch[nq],ch[q],<span class="keyword">sizeof</span>(ch[q]));</span><br><span class="line">            fa[nq]=fa[q];fa[q]=fa[np]=nq;</span><br><span class="line">            <span class="keyword">for</span>(;ch[p][c]==q;p=fa[p]) ch[p][c]=nq;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    f[np]++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) insert(s1[i] - <span class="string">'a'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;s1 + <span class="number">1</span>;</span><br><span class="line">    len = <span class="built_in">strlen</span>(s1 + <span class="number">1</span>);</span><br><span class="line">    build(len);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cnt;i++) sum[l[i]]++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= len;i++) sum[i] += sum[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cnt;i++) id[sum[l[i]]--] = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = cnt;i;i--) f[fa[id[i]]] += f[id[i]];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cnt;i++) ans[l[i]] = max(ans[l[i]],f[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = len;i;i--) ans[i] = max(ans[i + <span class="number">1</span>],ans[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= len;i++) <span class="built_in">cout</span>&lt;&lt;ans[i]&lt;&lt;<span class="string">" "</span>; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="L-qh与复读机XII"><a href="#L-qh与复读机XII" class="headerlink" title="L - qh与复读机XII"></a>L - qh与复读机XII</h5><blockquote>
<p>L、给出一个字符串$ S $，然后给出$ q $个询问，每个询问对应输出$S[l_1,r_1]$在$S[l_2,r_2]$中的出现次数</p>
</blockquote>
<p><code>后缀自动机</code> <code>线段树合并</code> <code>倍增</code> <code>right集合</code> <code>Parent树</code><br><del>什么好(po)题想了我三天时间</del><br>后缀自动机的构造过程我其实是比较懵的×<br>但是了解后缀自动机的性质的话这个题实际上就是一个数据结构题了。。。<br>首先要考虑的是找到$S[l_1,r_1]$在后缀自动机上对应的结点的位置，如果暴力的话就是$O(n^2)$了。。<br>然后去康了康<code>倍增算法</code>，先把$S[1,i]$能到达的结点位置预处理出来，实际上就是标记一下last的位置。。<br>然后$O(nlogn)$倍增找到$S[l_1,r_1]$的位置，那么剩下的事情就是要查询这个结点位置对应的$right集合$<br>$right$集合是需要从$parent$树自底向上合并集合得到，集合的合并？<br>用<code>set</code>的<code>insert</code>暴力搞？复杂度太大，启发式合并也救不了。。。。<br>那么用<code>pb_ds</code>的红黑树<code>join</code>？不行，区间不能相交（事后xyy给我说可以启发式合并一个一个插入是能保证复杂度的<br>然后我找到了一个神奇的东西——<code>线段树合并</code><br>线段树合并的时候，如果某个子节点是空的，那么就不需要合并下去了，这里用启发式合并的话保证了合并的复杂度是$O(nlog^2n)$<br>于是就可以做这个题了<br>最开始每个集合对应了一个$endpos$，那么先把它对应在线段树上的位置$+1$，那么查询在某个区间的子串出现次数的时候就只需要查询区间和即可，也就是用线段树维护一个区间和<br>令$len = r_1 - l_1 + 1$,每次查询的区间就是$[ l_2 + len  - 1, r_2]$，返回的区间和就是答案<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> s1[maxn];</span><br><span class="line"><span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> last = <span class="number">1</span>,cnt = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ch[maxn][<span class="number">26</span>],fa[maxn],l[maxn];</span><br><span class="line"><span class="keyword">int</span> id[maxn];</span><br><span class="line"><span class="keyword">int</span> f[maxn][<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,q,l1,r1,l2,r2;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> lchild[maxn&lt;&lt;<span class="number">3</span>],rchild[maxn&lt;&lt;<span class="number">3</span>],rt[maxn&lt;&lt;<span class="number">3</span>],sum[maxn&lt;&lt;<span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span> c[maxn],a[maxn],in[maxn];</span><br><span class="line"><span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> &amp;root,<span class="keyword">int</span> lp,<span class="keyword">int</span> rp,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root) root = ++tot;</span><br><span class="line">    <span class="keyword">if</span>(lp == rp) &#123;</span><br><span class="line">        sum[root] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (lp + rp)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x &lt;= mid) modify(lchild[root],lp,mid,x);</span><br><span class="line">    <span class="keyword">else</span> modify(rchild[root],mid + <span class="number">1</span>,rp,x);</span><br><span class="line">    sum[root] = sum[lchild[root]] + sum[rchild[root]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!x || !y) <span class="keyword">return</span> x^y;</span><br><span class="line">    <span class="keyword">int</span> p = ++tot;</span><br><span class="line">    lchild[p] = merge(lchild[x],lchild[y]);</span><br><span class="line">    rchild[p] = merge(rchild[x],rchild[y]);</span><br><span class="line">    sum[p] = sum[x] + sum[y];</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> root,<span class="keyword">int</span> lp,<span class="keyword">int</span> rp,<span class="keyword">int</span> L,<span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= lp &amp;&amp; rp &lt;= R) <span class="keyword">return</span> sum[root];</span><br><span class="line">    <span class="keyword">int</span> mid = (lp + rp) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(R &lt;= mid) <span class="keyword">return</span> query(lchild[root],lp,mid,L,R);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(L &gt; mid) <span class="keyword">return</span> query(rchild[root],mid + <span class="number">1</span>,rp,L,R);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> (query(lchild[root],lp,mid,L,R) + query(rchild[root],mid + <span class="number">1</span>,rp,L,R));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p=last,np=++cnt;</span><br><span class="line">    last=np,l[np]=l[p]+<span class="number">1</span>;</span><br><span class="line">    in[np] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(;p&amp;&amp;!ch[p][c];p=fa[p]) ch[p][c]=np;</span><br><span class="line">    <span class="keyword">if</span>(!p) fa[np]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> q=ch[p][c];</span><br><span class="line">        <span class="keyword">if</span>(l[q]==l[p]+<span class="number">1</span>) fa[np]=q;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> nq=++cnt;l[nq]=l[p]+<span class="number">1</span>;</span><br><span class="line">            <span class="built_in">memcpy</span>(ch[nq],ch[q],<span class="keyword">sizeof</span>(ch[q]));</span><br><span class="line">            fa[nq]=fa[q];fa[q]=fa[np]=nq;</span><br><span class="line">            <span class="keyword">for</span>(;ch[p][c]==q;p=fa[p]) ch[p][c]=nq;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> last;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) id[i] = insert(s1[i] - <span class="string">'a'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;q;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;s1 + <span class="number">1</span>;</span><br><span class="line">    build(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cnt;i++) c[l[i]]++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cnt;i++) c[i] += c[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cnt;i++) a[c[l[i]]--] = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = cnt;i;i--)&#123;</span><br><span class="line">        <span class="keyword">int</span> pos = a[i];</span><br><span class="line">        <span class="keyword">if</span>(in[pos]) modify(rt[pos],<span class="number">1</span>,n,l[pos]);</span><br><span class="line">        rt[fa[pos]] = merge(rt[fa[pos]],rt[pos]);</span><br><span class="line">        f[pos][<span class="number">0</span>] = fa[pos];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= <span class="number">18</span>;j++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cnt;i++)&#123;</span><br><span class="line">            f[i][j] = f[f[i][j - <span class="number">1</span>]][j - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= q;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;l1&gt;&gt;r1&gt;&gt;l2&gt;&gt;r2;</span><br><span class="line">        <span class="keyword">int</span> len1 = r1 - l1 + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> pos = id[r1];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">18</span>;j &gt;=<span class="number">0</span>;j--) <span class="keyword">if</span>(l[f[pos][j]] &gt;= len1) pos = f[pos][j];</span><br><span class="line">        <span class="keyword">int</span> lp = l2 + len1 - <span class="number">1</span>,rp = r2;</span><br><span class="line">        <span class="keyword">if</span>(lp &gt; rp) ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> ans = query(rt[pos],<span class="number">1</span>,n,lp,rp);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="M-一切的开始-世界树的测验"><a href="#M-一切的开始-世界树的测验" class="headerlink" title="M - 一切的开始,世界树的测验"></a>M - 一切的开始,世界树的测验</h5><blockquote>
<p>M、给出$ n $个数，可以有$ k $次机会将一个数改成$\sum _{ i = 1} ^ {x} i$，求选出若干个数字可以得到$ s $的方案数</p>
</blockquote>
<p><code>dfs</code> <code>meet in middle</code><br><del>又是您，您出的题可卡死我啰</del><br> 直接交了个裸的$O(3^n)$然后被制裁了<br> 顺着题解给的板子敲了一下$meet\ in \ middle$，zdynb<br> 先搜索一半把可能的情况存储起来，中间有一点剪枝<br> 然后再搜索后一半满足条件的就加到方案数里面<br> 时间复杂度$O(3^{n/2})$<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> a[<span class="number">30</span>];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> b[<span class="number">30</span>];</span><br><span class="line">ll n,k,s,mid;</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">map</span>&lt;ll,ll&gt; M[<span class="number">30</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(ll sum,ll cur,ll cnt)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(cur == mid + <span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(M[cnt][sum] == <span class="number">0</span>) M[cnt][sum] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span> M[cnt][sum] ++;</span><br><span class="line">		<span class="keyword">return</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	ll tmp = (a[cur] + <span class="number">1</span>) * a[cur] / <span class="number">2</span>;</span><br><span class="line">	dfs1(sum,cur + <span class="number">1</span>,cnt);</span><br><span class="line">	<span class="keyword">if</span>(a[cur] + sum &lt;= s) dfs1(sum + a[cur],cur + <span class="number">1</span>,cnt);</span><br><span class="line">	<span class="keyword">if</span>(cnt &lt; k &amp;&amp; tmp + sum &lt;= s) dfs1(sum + tmp,cur + <span class="number">1</span>,cnt + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(ll sum,ll cur,ll cnt)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(cur == n + <span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i + cnt &lt;= k;i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(M[i].count(s - sum)) ans += M[i][s - sum];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	ll tmp = (a[cur] + <span class="number">1</span>) * a[cur] / <span class="number">2</span>;</span><br><span class="line">	dfs2(sum,cur + <span class="number">1</span>,cnt);</span><br><span class="line">	<span class="keyword">if</span>(a[cur] + sum &lt;= s) dfs2(sum + a[cur],cur + <span class="number">1</span>,cnt);</span><br><span class="line">	<span class="keyword">if</span>(cnt &lt; k &amp;&amp; tmp + sum &lt;= s) dfs2(sum + tmp,cur + <span class="number">1</span>,cnt + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k&gt;&gt;s;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">	mid = n &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    dfs1(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    dfs2(<span class="number">0</span>,mid + <span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="N-第一个征程，噩梦的开始"><a href="#N-第一个征程，噩梦的开始" class="headerlink" title="N - 第一个征程，噩梦的开始"></a>N - 第一个征程，噩梦的开始</h5><blockquote>
<p>N、给出一个地图以及限制条件，输出最多能到达的位置数量</p>
</blockquote>
<p><code>BFS</code><br>一开始没读懂题。。。然后就都是等到题解下来了才写的。。<br>其实思路很简单，就是BFS一遍，不过要用deque维护一下优先拓展上下位置，因为花费是0<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n,m,x,y;</span><br><span class="line"><span class="keyword">int</span> xx,yy;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> x,y;</span><br><span class="line">	<span class="keyword">int</span> l,r;</span><br><span class="line"></span><br><span class="line">	node(<span class="keyword">int</span> posx,<span class="keyword">int</span> posy,<span class="keyword">int</span> posl,<span class="keyword">int</span> posr):x(posx),y(posy),l(posl),r(posr)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">char</span> mmp[<span class="number">2500</span>][<span class="number">2500</span>];</span><br><span class="line"><span class="keyword">bool</span> vis[<span class="number">2500</span>][<span class="number">2500</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">deque</span>&lt;node&gt; Q;</span><br><span class="line">	Q.push_back(node(x,y - <span class="number">1</span>,xx,yy));</span><br><span class="line">	<span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">	vis[x][y - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(!Q.empty())&#123;</span><br><span class="line">		node cur = Q.front();</span><br><span class="line">		Q.pop_front();</span><br><span class="line">		<span class="keyword">if</span>(cur.y + <span class="number">1</span> &lt; m &amp;&amp; mmp[cur.x][cur.y + <span class="number">1</span>] != <span class="string">'*'</span> &amp;&amp; !vis[cur.x][cur.y + <span class="number">1</span>] &amp;&amp; cur.r != <span class="number">0</span>)&#123;</span><br><span class="line">			vis[cur.x][cur.y + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">			ans++;</span><br><span class="line">			Q.push_back(node(cur.x,cur.y + <span class="number">1</span>,cur.l,cur.r - <span class="number">1</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(cur.y - <span class="number">1</span> &gt;= <span class="number">0</span> &amp;&amp; mmp[cur.x][cur.y - <span class="number">1</span>] != <span class="string">'*'</span> &amp;&amp; !vis[cur.x][cur.y - <span class="number">1</span>] &amp;&amp; cur.l != <span class="number">0</span>)&#123;</span><br><span class="line">			vis[cur.x][cur.y - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">			ans++;</span><br><span class="line">			Q.push_back(node(cur.x,cur.y - <span class="number">1</span>,cur.l - <span class="number">1</span>,cur.r));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(cur.x - <span class="number">1</span> &gt;= <span class="number">1</span> &amp;&amp; mmp[cur.x - <span class="number">1</span>][cur.y] != <span class="string">'*'</span> &amp;&amp; !vis[cur.x - <span class="number">1</span>][cur.y])&#123;</span><br><span class="line">			vis[cur.x - <span class="number">1</span>][cur.y] = <span class="number">1</span>;</span><br><span class="line">			ans++;</span><br><span class="line">			Q.push_front(node(cur.x - <span class="number">1</span>,cur.y,cur.l,cur.r));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(cur.x + <span class="number">1</span> &lt;= n &amp;&amp; mmp[cur.x + <span class="number">1</span>][cur.y] != <span class="string">'*'</span> &amp;&amp; !vis[cur.x + <span class="number">1</span>][cur.y])&#123;</span><br><span class="line">			vis[cur.x + <span class="number">1</span>][cur.y] = <span class="number">1</span>;</span><br><span class="line">			ans++;</span><br><span class="line">			Q.push_front(node(cur.x + <span class="number">1</span>,cur.y,cur.l,cur.r));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m&gt;&gt;x&gt;&gt;y&gt;&gt;xx&gt;&gt;yy;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;mmp[i];</span><br><span class="line">	&#125;</span><br><span class="line">	bfs();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="O-第二个征程，拔起剪枝哀伤"><a href="#O-第二个征程，拔起剪枝哀伤" class="headerlink" title="O - 第二个征程，拔起剪枝哀伤"></a>O - 第二个征程，拔起剪枝哀伤</h5><blockquote>
<p>O、给定$n$个数，求出一个序列使得这n个数均可以由所得序列中的数作差得到</p>
</blockquote>
<p><code>dfs</code> <code>迭代加深</code><br>用状态压缩将现在能得到的$a_i$表示出来，然后每次搜索如果在某个深度不能得到解，就向下加深。。<br>主要的就是状态变换的位置容易写错，而且用lower_bound的话可以优化一下时间复杂度<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mst(a,b) memset(a,b,sizeof(a))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> n,a[<span class="number">60</span>],ans[<span class="number">60</span>];</span><br><span class="line"><span class="keyword">int</span> dep = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> cur,<span class="keyword">long</span> <span class="keyword">long</span> statu)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(cur == dep)&#123;</span><br><span class="line">		ans[cur] = a[n];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= cur - <span class="number">1</span>;k++)&#123;</span><br><span class="line">			<span class="keyword">int</span> tmp = a[n] - ans[k];</span><br><span class="line">			<span class="keyword">int</span> pos = lower_bound(a + <span class="number">1</span>,a + n + <span class="number">1</span>,tmp) - a;</span><br><span class="line">			<span class="keyword">if</span>(a[pos] == tmp)&#123;</span><br><span class="line">				statu = statu | (<span class="number">1l</span>l &lt;&lt; (pos - <span class="number">1</span>));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> statu == (<span class="number">1l</span>l &lt;&lt; n) - <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= cur - <span class="number">1</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n - <span class="number">1</span>;j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(statu &amp; (<span class="number">1l</span>l &lt;&lt; (j - <span class="number">1</span>))) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">int</span> tmp = ans[i] + a[j];</span><br><span class="line">			<span class="keyword">if</span>(tmp &lt;= ans[cur - <span class="number">1</span>] || tmp &gt;= a[n]) <span class="keyword">continue</span>;</span><br><span class="line">			ans[cur] = tmp;</span><br><span class="line">			<span class="keyword">long</span> <span class="keyword">long</span> nxt = statu;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= cur - <span class="number">1</span>;k++)&#123;</span><br><span class="line">				<span class="keyword">int</span> ttmp = tmp - ans[k];</span><br><span class="line">				<span class="keyword">int</span> pos = lower_bound(a + <span class="number">1</span>,a + n + <span class="number">1</span>,ttmp) - a;</span><br><span class="line">				<span class="keyword">if</span>(a[pos] == ttmp)&#123;</span><br><span class="line">					nxt = nxt | (<span class="number">1l</span>l &lt;&lt; (pos - <span class="number">1</span>));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(dfs(cur + <span class="number">1</span>,nxt)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++) <span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">	sort(a + <span class="number">1</span>,a + n + <span class="number">1</span>);</span><br><span class="line">	n = unique(a + <span class="number">1</span>,a + n + <span class="number">1</span>) - (a + <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">if</span>(n == <span class="number">1</span>)&#123;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="number">2</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="number">0</span>&lt;&lt;<span class="string">" "</span>&lt;&lt;a[<span class="number">1</span>]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	mst(ans,<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">while</span>(!dfs(<span class="number">2</span>,<span class="number">0</span>))&#123;</span><br><span class="line">		dep++;</span><br><span class="line">		mst(ans,<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;dep&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= dep;i++) <span class="built_in">cout</span>&lt;&lt;ans[i]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="P-征程的结束，吉安娜"><a href="#P-征程的结束，吉安娜" class="headerlink" title="P - 征程的结束，吉安娜"></a>P - 征程的结束，吉安娜</h5><blockquote>
<p>P、先给出一个01矩阵，0表示不能移动的建筑，1表示能移动的建筑或者水晶，给出水晶坐标位置，以及两个坐标，问从一个坐标到另外一个坐标的最小时间花费</p>
</blockquote>
<p><code>dfs</code> <code>spfa</code> <code>最短路</code></p>
<p>先spfa预处理出可能的空白格子（就是1的位置）到某个指定位置的上下左右的时间代价<br>这里用$dist_{x_1,y_1,x_2,y_2,dir}$表示状态<br>然后用启发式搜索减小dfs经过重复路径的次数来加快dfs的效率即可<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 1e8</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mst(a,b) memset(a,b,sizeof(a))</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pos</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> x,y;</span><br><span class="line"></span><br><span class="line">	pos(<span class="keyword">int</span> xx,<span class="keyword">int</span> yy):x(xx),y(yy)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mmp[<span class="number">40</span>][<span class="number">40</span>];</span><br><span class="line"><span class="keyword">int</span> n,m,q,ans;</span><br><span class="line"><span class="keyword">int</span> dist[<span class="number">40</span>][<span class="number">40</span>][<span class="number">40</span>][<span class="number">40</span>][<span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> vis[<span class="number">40</span>][<span class="number">40</span>][<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dirx[] = &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> diry[] = &#123;<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> a,b,c,d,ex,ey;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> cx,<span class="keyword">int</span> cy)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(cx &gt;= <span class="number">1</span> &amp;&amp; cx &lt;= n &amp;&amp; cy &gt;= <span class="number">1</span> &amp;&amp; cy &lt;= m &amp;&amp; mmp[cx][cy]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> nowx,<span class="keyword">int</span> nowy,<span class="keyword">int</span> dir)</span></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> vvis[<span class="number">50</span>][<span class="number">50</span>];</span><br><span class="line">	<span class="built_in">queue</span>&lt;pos&gt; q;</span><br><span class="line">	q.push(pos(x,y));</span><br><span class="line">	dist[x][y][x][y][dir] = <span class="number">0</span>;</span><br><span class="line">	mst(vvis,<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">		pos now = q.front();</span><br><span class="line">		q.pop();</span><br><span class="line">		vvis[now.x][now.y] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)&#123;</span><br><span class="line">			<span class="keyword">int</span> nxtx = now.x + dirx[i],nxty = now.y + diry[i];</span><br><span class="line">			<span class="keyword">if</span>(check(nxtx,nxty) &amp;&amp; (nxtx != nowx || nxty != nowy))&#123;</span><br><span class="line">				<span class="keyword">if</span>(dist[x][y][nxtx][nxty][dir] &gt; dist[x][y][now.x][now.y][dir] + <span class="number">1</span>)&#123;</span><br><span class="line">					dist[x][y][nxtx][nxty][dir] = dist[x][y][now.x][now.y][dir] + <span class="number">1</span>;</span><br><span class="line">					<span class="keyword">if</span>(!vvis[nxtx][nxty])&#123;</span><br><span class="line">						q.push(pos(nxtx,nxty));</span><br><span class="line">						vvis[nxtx][nxty] = <span class="number">1</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> kx,<span class="keyword">int</span> ky,<span class="keyword">int</span> sx,<span class="keyword">int</span> sy,<span class="keyword">int</span> cnt,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(cnt &gt;= ans) <span class="keyword">return</span> ;</span><br><span class="line">	<span class="keyword">if</span>(sx == ex &amp;&amp; sy == ey) &#123;</span><br><span class="line">		ans = cnt;</span><br><span class="line">		<span class="keyword">return</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(vis[sx][sy][k] &lt;= cnt) <span class="keyword">return</span> ;</span><br><span class="line">    vis[sx][sy][k] = cnt;</span><br><span class="line">    <span class="keyword">int</span> used[<span class="number">4</span>] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> dir,len;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        len = INF;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">4</span>;j ++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = sx + dirx[j],y = sy + diry[j];</span><br><span class="line">            <span class="keyword">if</span>(check(x,y) &amp;&amp; len &gt; dist[x][y][kx][ky][(j+<span class="number">2</span>)%<span class="number">4</span>] &amp;&amp; !used[j])</span><br><span class="line">                len = dist[x][y][kx][ky][(j+<span class="number">2</span>)%<span class="number">4</span>],dir = j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(len != INF)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = x = sx + dirx[dir],y = sy + diry[dir];</span><br><span class="line">            used[dir] = <span class="number">1</span>;</span><br><span class="line">            dfs(sx,sy,x,y,cnt+dist[x][y][kx][ky][(dir+<span class="number">2</span>)%<span class="number">4</span>]+<span class="number">1</span>,(dir+<span class="number">2</span>)%<span class="number">4</span>);</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m&gt;&gt;q;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= m;j++)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;mmp[i][j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	mst(dist,<span class="number">0x3f</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= m;j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(!mmp[i][j]) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k &lt; <span class="number">4</span>;k++)&#123;</span><br><span class="line">				<span class="keyword">int</span> nxtx = i + dirx[k];</span><br><span class="line">				<span class="keyword">int</span> nxty = j + diry[k];</span><br><span class="line">				<span class="keyword">if</span>(check(nxtx,nxty))&#123;</span><br><span class="line">					spfa(i,j,nxtx,nxty,k);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= q;i++)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;a&gt;&gt;b&gt;&gt;c&gt;&gt;d&gt;&gt;ex&gt;&gt;ey;</span><br><span class="line">		ans = INF;</span><br><span class="line">		mst(vis,<span class="number">0x3f</span>);</span><br><span class="line">		dfs(a,b,c,d,<span class="number">0</span>,<span class="number">4</span>);</span><br><span class="line">		<span class="keyword">if</span>(ans == INF) <span class="built_in">cout</span>&lt;&lt;<span class="number">-1</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="Q-猛男24点"><a href="#Q-猛男24点" class="headerlink" title="Q - 猛男24点"></a>Q - 猛男24点</h5><blockquote>
<p>Q、两个人对弈，给出牌区的4张牌以及两个人的手牌，先手的获胜策略是到他的时候牌区能凑成24点，而后手的获胜条件是到他的时候牌区不能凑成24点，先手可以进行的操作是将自己的牌换到牌区里面，后手可以进行的操作是将牌区的牌与自己手中的黑牌进行交换。如果先手第一局不换牌，那么游戏会继续，反之游戏结束。</p>
</blockquote>
<p><code>博弈</code> <code>搜索</code> <code>枚举</code><br>到先手的时候，如果能够凑成24点，那么当前不是第一局或者后手必败的情况下即可获胜<br>而到后手的时候，只要不能凑成24点，那么就可以获胜了<br>先枚举24点的情况将其哈希之后可以方便判断<br>然后每次回溯注意要写在dfs的前后。。。如果放在if后面的情况下可能没法回溯回去就直接返回了（我傻了<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-6</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">statu</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> num[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">	statu(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c,<span class="keyword">int</span> d)&#123;</span><br><span class="line">		num[<span class="number">0</span>] = a;</span><br><span class="line">		num[<span class="number">1</span>] = b;</span><br><span class="line">		num[<span class="number">2</span>] = c;</span><br><span class="line">		num[<span class="number">3</span>] = d;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> statu &amp;a) <span class="keyword">const</span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(num[i] == a.num[i]) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> statu &amp;a) <span class="keyword">const</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(num[<span class="number">0</span>] == a.num[<span class="number">0</span>])&#123;</span><br><span class="line">			<span class="keyword">if</span>(num[<span class="number">1</span>] == a.num[<span class="number">1</span>])&#123;</span><br><span class="line">				<span class="keyword">if</span>(num[<span class="number">2</span>] == a.num[<span class="number">2</span>])&#123;</span><br><span class="line">					<span class="keyword">return</span> num[<span class="number">3</span>] &lt; a.num[<span class="number">3</span>];</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> num[<span class="number">2</span>] &lt; a.num[<span class="number">2</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> num[<span class="number">1</span>] &lt; a.num[<span class="number">1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> num[<span class="number">0</span>] &lt; a.num[<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">card</span>&#123;</span></span><br><span class="line">	<span class="keyword">bool</span> color;</span><br><span class="line">	<span class="keyword">int</span> num;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> a[<span class="number">4</span>];</span><br><span class="line"><span class="keyword">int</span> nows[<span class="number">4</span>];</span><br><span class="line">card cards[<span class="number">10</span>],card1[<span class="number">10</span>],card2[<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> T,n,m;</span><br><span class="line"><span class="keyword">bool</span> used[<span class="number">10</span>];</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; M;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cal</span><span class="params">(<span class="keyword">double</span> a,<span class="keyword">double</span> b,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(k == <span class="number">1</span>) <span class="keyword">return</span> (a + b);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(k == <span class="number">2</span>) <span class="keyword">return</span> (a - b);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(k == <span class="number">3</span>) <span class="keyword">return</span> (a * b);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(k == <span class="number">4</span>) <span class="keyword">return</span> (a / b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i&lt;=<span class="number">4</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= <span class="number">4</span>;j++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= <span class="number">4</span>;k++)&#123;</span><br><span class="line">				<span class="keyword">double</span> tmp1,tmp2,tmp3;</span><br><span class="line">				tmp1 = cal(a[<span class="number">0</span>],a[<span class="number">1</span>],i);</span><br><span class="line">				tmp2 = cal(tmp1,a[<span class="number">2</span>],j);</span><br><span class="line">				tmp3 = cal(tmp2,a[<span class="number">3</span>],k);</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">fabs</span>(tmp3 - <span class="number">24</span>) &lt; eps) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">				tmp1 = cal(a[<span class="number">0</span>],a[<span class="number">1</span>],i);</span><br><span class="line">				tmp2 = cal(a[<span class="number">2</span>],a[<span class="number">3</span>],k);</span><br><span class="line">				tmp3 = cal(tmp1,tmp2,j);</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">fabs</span>(tmp3 - <span class="number">24</span>) &lt; eps) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">				tmp1 = cal(a[<span class="number">1</span>],a[<span class="number">2</span>],j);</span><br><span class="line">				tmp2 = cal(a[<span class="number">0</span>],tmp1,i);</span><br><span class="line">				tmp3 = cal(tmp2,a[<span class="number">3</span>],k);</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">fabs</span>(tmp3 - <span class="number">24</span>) &lt; eps) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">				tmp1 = cal(a[<span class="number">1</span>],a[<span class="number">2</span>],j);</span><br><span class="line">				tmp2 = cal(tmp1,a[<span class="number">3</span>],k);</span><br><span class="line">				tmp3 = cal(tmp2,a[<span class="number">0</span>],i);</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">fabs</span>(tmp3 - <span class="number">24</span>) &lt; eps) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">				tmp1 = cal(a[<span class="number">2</span>],a[<span class="number">3</span>],k);</span><br><span class="line">				tmp2 = cal(a[<span class="number">1</span>],tmp1,j);</span><br><span class="line">				tmp3 = cal(a[<span class="number">0</span>],tmp2,i);</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">fabs</span>(tmp3 - <span class="number">24</span>) &lt; eps) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">double</span> i = <span class="number">1.0</span>;i &lt;= <span class="number">10.0</span>;i += <span class="number">1.0</span>)&#123;</span><br><span class="line">		a[<span class="number">0</span>] = i;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">double</span> j = <span class="number">1.0</span>;j &lt;= <span class="number">10.0</span>;j += <span class="number">1.0</span>)&#123;</span><br><span class="line">			a[<span class="number">1</span>] = j;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">double</span> k = <span class="number">1.0</span>;k &lt;= <span class="number">10.0</span>;k += <span class="number">1.0</span>)&#123;</span><br><span class="line">				a[<span class="number">2</span>] = k;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">double</span> l = <span class="number">1.0</span>;l &lt;= <span class="number">10.0</span>;l += <span class="number">1.0</span>)&#123;</span><br><span class="line">					a[<span class="number">3</span>] = l;</span><br><span class="line">					<span class="keyword">int</span> b[<span class="number">4</span>];</span><br><span class="line">					<span class="keyword">if</span>(check())&#123;</span><br><span class="line">					    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++) b[i] = a[i];</span><br><span class="line">					    sort(b,b + <span class="number">4</span>);</span><br><span class="line">			            <span class="keyword">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">				        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++) tmp = tmp * <span class="number">11</span> + b[i];</span><br><span class="line">						<span class="keyword">if</span>(M[tmp] == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">				        M[tmp] = <span class="number">1</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">(statu x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> b[<span class="number">4</span>];</span><br><span class="line">	<span class="keyword">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++) b[i] = nows[i];</span><br><span class="line">	sort(b,b + <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++) tmp = tmp * <span class="number">11</span> + b[i];</span><br><span class="line">    <span class="keyword">if</span>(M[tmp] == <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">bool</span> now,<span class="keyword">int</span> dep)</span></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> nowstatu = find(statu(nows[<span class="number">0</span>],nows[<span class="number">1</span>],nows[<span class="number">2</span>],nows[<span class="number">3</span>]));</span><br><span class="line">	<span class="keyword">if</span>(now == <span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(nowstatu)&#123;</span><br><span class="line">			<span class="keyword">if</span>(dep != <span class="number">1</span> || dfs(!now,dep + <span class="number">1</span>)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(!used[i])&#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= <span class="number">4</span>;j++)&#123;</span><br><span class="line">					swap(card1[i],cards[j]);</span><br><span class="line">					nows[j - <span class="number">1</span>] = cards[j].num;</span><br><span class="line">					used[i] = <span class="number">1</span>;</span><br><span class="line">					<span class="keyword">bool</span> flag = dfs(!now,dep + <span class="number">1</span>);</span><br><span class="line">					used[i] = <span class="number">0</span>;</span><br><span class="line">					swap(card1[i],cards[j]);</span><br><span class="line">					nows[j - <span class="number">1</span>] = cards[j].num;</span><br><span class="line">					<span class="keyword">if</span>(flag == <span class="literal">true</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(!nowstatu) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(card2[i].color == <span class="number">0</span>)&#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= <span class="number">4</span>;j++)&#123;</span><br><span class="line">					swap(card2[i],cards[j]);</span><br><span class="line">					nows[j - <span class="number">1</span>] = cards[j].num;</span><br><span class="line">					<span class="keyword">bool</span> flag = dfs(!now,dep + <span class="number">1</span>);</span><br><span class="line">					swap(card2[i],cards[j]);</span><br><span class="line">					nows[j - <span class="number">1</span>] = cards[j].num;</span><br><span class="line">					<span class="keyword">if</span>(flag == <span class="literal">false</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	init();</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;T;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= T;i++)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(used,<span class="number">0</span>,<span class="keyword">sizeof</span>(used));</span><br><span class="line">		<span class="keyword">char</span> c;</span><br><span class="line">		<span class="keyword">int</span> num;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= <span class="number">4</span>;j++)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;num&gt;&gt;c;</span><br><span class="line">			cards[j].num = num,cards[j].color = (c == <span class="string">'b'</span> ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">			nows[j - <span class="number">1</span>] = num;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;num&gt;&gt;c;</span><br><span class="line">			card1[j].num = num,card1[j].color = (c == <span class="string">'b'</span> ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= m;j++)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;num&gt;&gt;c;</span><br><span class="line">			card2[j].num = num,card2[j].color = (c == <span class="string">'b'</span> ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(dfs(<span class="number">0</span>,<span class="number">1</span>)) <span class="built_in">cout</span>&lt;&lt;<span class="string">"You are MengNan!"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;<span class="string">"Gan si 25zai!"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="R-如果早知道wf题也会被ak"><a href="#R-如果早知道wf题也会被ak" class="headerlink" title="R - 如果早知道wf题也会被ak"></a>R - 如果早知道wf题也会被ak</h5><blockquote>
<p>R、给出一个长度为$n$的字符串，求其最长偶回文子串的长度</p>
</blockquote>
<p><code>Manacher</code><br>马拉车板题，在板子上面改一下就可以了。。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> s1[<span class="number">30000007</span>],s2[<span class="number">30000007</span>];</span><br><span class="line"><span class="keyword">int</span> p[<span class="number">30000007</span>],id = <span class="number">1</span>,mx = <span class="number">1</span>,ans = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    s2[<span class="number">0</span>] = <span class="string">'$'</span>;</span><br><span class="line">    s2[<span class="number">1</span>] = <span class="string">'#'</span>;</span><br><span class="line">    <span class="keyword">int</span> j = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s1);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        s2[j++] = s1[i];</span><br><span class="line">        s2[j++] = <span class="string">'#'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    s2[j] = <span class="string">'\0'</span>;</span><br><span class="line">    <span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(p,<span class="number">0</span>,<span class="keyword">sizeof</span>(p));</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;s1;</span><br><span class="line">    <span class="keyword">int</span> len = init();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i&lt;len;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i &lt; mx) p[i] = min(p[<span class="number">2</span> * id - i],mx - i);</span><br><span class="line">        <span class="keyword">else</span> p[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(s2[i - p[i]] == s2[i + p[i]])&#123;</span><br><span class="line">            p[i] ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(s2[i] == <span class="string">'#'</span>) ans = max(ans,p[i] - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(mx &lt; i + p[i])&#123;</span><br><span class="line">            id = i;</span><br><span class="line">            mx = i + p[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="S-如果早知道wf题也会被ak-DLC1"><a href="#S-如果早知道wf题也会被ak-DLC1" class="headerlink" title="S - 如果早知道wf题也会被ak - DLC1"></a>S - 如果早知道wf题也会被ak - DLC1</h5><blockquote>
<p>S、给出两个字符串，求这两个串的最长公共子串长度</p>
</blockquote>
<p><code>SA</code> <code>SAM</code> <code>Height数组</code><br>也是一个求LCP的板题，一开始交了写好的SA上去结果RE了（写糊了<br>然后心态崩了抄了一个SAM上去。。。这里还是放一下SA的代码<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> s1[MAX],s2[MAX];</span><br><span class="line"><span class="keyword">int</span> sa[MAX],h[MAX],x[MAX],y[MAX],r[MAX],rk[MAX],m,ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> len1,len2;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> *r,<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> r[a] == r[b] &amp;&amp; r[a+len] == r[b+len];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SA</span><span class="params">()</span></span>&#123;</span><br><span class="line">	m = M;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;=m;i++) r[i] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;len1;i++) r[x[i] = s1[i]] ++;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i&lt;=m;i++) r[i] += r[i - <span class="number">1</span>];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = len1 - <span class="number">1</span>;i&gt;=<span class="number">0</span>;i--) sa[--r[x[i]]] = i;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>,p = <span class="number">1</span>;j&lt;=len1;j&lt;&lt;=<span class="number">1</span>,m = p)&#123;</span><br><span class="line">		p = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = len1 - j;i&lt;len1;i++) y[p++] = i;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;len1;i++) <span class="keyword">if</span>(sa[i] &gt;= j) y[p++] = sa[i] - j;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;=m;i++) r[i] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;len1;i++) r[x[i]] ++;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;=m;i++) r[i] += r[i - <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = len1 - <span class="number">1</span>;i&gt;=<span class="number">0</span>;i--) sa[--r[x[y[i]]]] = y[i];</span><br><span class="line">		swap(x,y);</span><br><span class="line">	    p = <span class="number">1</span>;</span><br><span class="line">	    x[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line">	    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i&lt;len1;i++) x[sa[i]] = cmp(y,sa[i<span class="number">-1</span>],sa[i],j)?p<span class="number">-1</span>:p++;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">int</span> j,k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;len1;i++) rk[sa[i]] = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;len1;h[rk[i++]] = k)</span><br><span class="line">    <span class="keyword">for</span>(k?k--:<span class="number">0</span>,j = sa[rk[i] - <span class="number">1</span>];s1[i + k] == s1[j + k];k++);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;s1&gt;&gt;s2;</span><br><span class="line">	len1 = <span class="built_in">strlen</span>(s1);</span><br><span class="line">	len2 = <span class="built_in">strlen</span>(s2);</span><br><span class="line">	s1[len1] = <span class="string">'$'</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;len2;i++) s1[i + len1 + <span class="number">1</span>] = s2[i];</span><br><span class="line">    <span class="keyword">int</span> tmp = len1;</span><br><span class="line">	len1 = len1+len2+<span class="number">1</span>;</span><br><span class="line">    len2 = tmp;</span><br><span class="line">    SA();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;len1;i++)&#123;</span><br><span class="line">    	<span class="keyword">if</span>(h[i] &gt; <span class="number">1</span>)&#123;</span><br><span class="line">    		<span class="keyword">if</span>(min(sa[i],sa[i<span class="number">-1</span>]) &lt; len2 &amp;&amp; max(sa[i<span class="number">-1</span>],sa[i]) &gt; len2)&#123;</span><br><span class="line">    			<span class="keyword">if</span>(ans &lt; h[i]) ans = h[i];</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/字符串/" rel="tag"># 字符串</a>
          
            <a href="/tags/ACM/" rel="tag"># ACM</a>
          
            <a href="/tags/搜索/" rel="tag"># 搜索</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/06/02/UESTC暑期前集训-图论/" rel="next" title="UESTC暑假前集训—图论-解题报告">
                <i class="fa fa-chevron-left"></i> UESTC暑假前集训—图论-解题报告
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/06/28/Codeforces-570-div3解题报告/" rel="prev" title="Codeforces-570-div3解题报告">
                Codeforces-570-div3解题报告 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://s.gravatar.com/avatar/d3c332e47b56134bab228c086c6578d5?s=250" alt="Decision">
            
              <p class="site-author-name" itemprop="name">Decision</p>
              <div class="site-description motion-element" itemprop="description">山河犹在 故人长绝</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">20</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">9</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">21</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/Decision2016" title="GitHub &rarr; https://github.com/Decision2016" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://blog.csdn.net/decision2016" title="CSDN &rarr; https://blog.csdn.net/decision2016" rel="noopener" target="_blank"><i class="fa fa-fw fa-CSDN"></i>CSDN</a>
                </span>
              
            </div>
          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://herano.github.io/" title="https://herano.github.io/" rel="noopener" target="_blank">HeRaNO's blog</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.f1ag.com/" title="http://www.f1ag.com/" rel="noopener" target="_blank">F1ag's blog</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://joytsing.github.io/" title="https://joytsing.github.io/" rel="noopener" target="_blank">JoyTing's blog</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-5"><a class="nav-link" href="#A-qh与复读机I"><span class="nav-number">1.</span> <span class="nav-text">A - qh与复读机I</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#B-qh与复读机II"><span class="nav-number">2.</span> <span class="nav-text">B - qh与复读机II</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#C-qh与复读机III"><span class="nav-number">3.</span> <span class="nav-text">C - qh与复读机III</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#D-qh与复读机IV"><span class="nav-number">4.</span> <span class="nav-text">D - qh与复读机IV</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#E-qh与复读机V"><span class="nav-number">5.</span> <span class="nav-text">E - qh与复读机V</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#F-qh与复读机VI"><span class="nav-number">6.</span> <span class="nav-text">F - qh与复读机VI</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#G-qh与复读机VII"><span class="nav-number">7.</span> <span class="nav-text">G - qh与复读机VII</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#H-qh与复读机VIII"><span class="nav-number">8.</span> <span class="nav-text">H - qh与复读机VIII</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#I-qh与复读机IX"><span class="nav-number">9.</span> <span class="nav-text">I - qh与复读机IX</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#J-qh与复读机X"><span class="nav-number">10.</span> <span class="nav-text">J - qh与复读机X</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#K-qh与复读机XI"><span class="nav-number">11.</span> <span class="nav-text">K - qh与复读机XI</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#L-qh与复读机XII"><span class="nav-number">12.</span> <span class="nav-text">L - qh与复读机XII</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#M-一切的开始-世界树的测验"><span class="nav-number">13.</span> <span class="nav-text">M - 一切的开始,世界树的测验</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#N-第一个征程，噩梦的开始"><span class="nav-number">14.</span> <span class="nav-text">N - 第一个征程，噩梦的开始</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#O-第二个征程，拔起剪枝哀伤"><span class="nav-number">15.</span> <span class="nav-text">O - 第二个征程，拔起剪枝哀伤</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#P-征程的结束，吉安娜"><span class="nav-number">16.</span> <span class="nav-text">P - 征程的结束，吉安娜</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Q-猛男24点"><span class="nav-number">17.</span> <span class="nav-text">Q - 猛男24点</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#R-如果早知道wf题也会被ak"><span class="nav-number">18.</span> <span class="nav-text">R - 如果早知道wf题也会被ak</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#S-如果早知道wf题也会被ak-DLC1"><span class="nav-number">19.</span> <span class="nav-text">S - 如果早知道wf题也会被ak - DLC1</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Decision</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.0.1</div>


<div class="BbeiAn-info"">
  黔ICP备 -
  <a href="http://www.beian.miit.gov.cn/">19010318-1</a>
  
</div>



<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="总访客量">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="总访问量">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>




  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  
  
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unjkp.com/valine/dist/Valine.min.js"></script>
  <script src="/js/src/Valine.min.js"></script>

  
  
  <script src="/js/src/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(function (item) {
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: true,
        notify: false,
        appId: 'r7u2cTYXLzmJRW6AzAH1pUGL-gzGzoHsz',
        appKey: 'qtmKFWEuvpURfvlnG77J5RS0',
        placeholder: 'Just go go',
        avatar:'mp',
        guest_info:guest,
        pageSize:'10' || 10,
    });
    var infoEle = document.querySelector('#comments .info');
    if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0){
      infoEle.childNodes.forEach(function(item) {
        item.parentNode.removeChild(item);
      });
    }
  </script>




  


  




  
  
  <script>
    
    function addCount(Counter) {
      var $visitors = $('.leancloud_visitors');
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url }) })
        .done(function({ results }) {
          if (results.length > 0) {
            var counter = results[0];
            
              var $element = $(document.getElementById(url));
              $element.find('.leancloud-visitors-count').text(counter.time + 1);
            
            Counter('put', '/classes/Counter/' + counter.objectId, JSON.stringify({ time: { '__op': 'Increment', 'amount': 1 } }))
            
              .fail(function ({ responseJSON }) {
                console.log('Failed to save Visitor num, with error message: ' + responseJSON.error);
              })
          } else {
            
              Counter('post', '/classes/Counter', JSON.stringify({ title: title, url: url, time: 1 }))
                .done(function() {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(1);
                })
                .fail(function() {
                  console.log('Failed to create');
                });
            
          }
        })
        .fail(function ({ responseJSON }) {
          console.log('LeanCloud Counter Error: ' + responseJSON.code + ' ' + responseJSON.error);
        });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + 'r7u2cTYXLzmJRW6AzAH1pUGL-gzGzoHsz')
        .done(function({ api_server }) {
          var Counter = function(method, url, data) {
            return $.ajax({
              method: method,
              url: 'https://' + api_server + '/1.1' + url,
              headers: {
                'X-LC-Id': 'r7u2cTYXLzmJRW6AzAH1pUGL-gzGzoHsz',
                'X-LC-Key': 'qtmKFWEuvpURfvlnG77J5RS0',
                'Content-Type': 'application/json',
              },
              data: data
            });
          };
          
            addCount(Counter);
          
        });
    });
  </script>



  

  
  

  
  

  
    
      <script type="text/x-mathjax-config">
  

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });
  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') { next = next.nextSibling }
        if (next && next.nodeName.toLowerCase() === 'br') { next.parentNode.removeChild(next) }
      }
    });
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      document.getElementById(all[i].inputID + '-Frame').parentNode.className += ' has-jax';
    }
  });
</script>
<script src="//cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    
  


  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

  

  

  

  

  

</body>
</html>
